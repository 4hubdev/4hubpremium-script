-- ============================================================
-- Vhub - INTERFACE COMPLÃˆTE AVEC WHITELIST & DRAG SYSTEM
-- ============================================================

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- ============================================================
-- WHITELIST SYSTEM
-- ============================================================
local WHITELIST = {
    -- FORMAT: [UserID] = true,
    -- AJOUTE LES USER IDS ICI (JUSQU'Ã€ 1000+ PERSONNES)
    [9230563404] = true,  -- Exemple UserID
    [8083834888] = true,  -- Exemple UserID
    [111222333] = true,  -- Exemple UserID
    [8176309904] = true,  -- Exemple UserID
    -- Ajoute autant d'IDs que tu veux...
}

-- FONCTION DE VÃ‰RIFICATION WHITELIST
local function checkWhitelist()
    if not WHITELIST[LocalPlayer.UserId] then
        -- FREEZER/BUGGER LE JEU pendant 4 secondes (3 + 1)
        local startTime = tick()
        while tick() - startTime < 4 do
            -- Boucle intensive pour freezer le jeu
            for i = 1, 100000 do
                local x = math.sqrt(i) * math.random()
            end
        end
        
        -- Kick le joueur aprÃ¨s 4 secondes
        LocalPlayer:Kick("Vous n'Ãªtes pas whitelist")
        return false
    end
    return true
end

-- VÃ‰RIFIER LA WHITELIST AU DÃ‰MARRAGE
if not checkWhitelist() then
    return -- ArrÃªte le script si pas whitelist
end

-- ============================================================
-- CONFIGURATION
-- ============================================================
local CONFIG = {
    WAYPOINTS = {
        {name = "Point A", pos = Vector3.new(-351.76, -6.66, 20.29)},
        {name = "Point B", pos = Vector3.new(-332.14, -4.51, 18.41)},
    },
    DELAY = 0.15,
    COOLDOWN = 0.5,
    THEME = {
        Background = Color3.fromRGB(0, 0, 0),
        Text = Color3.fromRGB(255, 255, 255),
        TextDim = Color3.fromRGB(150, 150, 150),
        Accent = Color3.fromRGB(255, 200, 0),
        Success = Color3.fromRGB(0, 255, 150),
        Error = Color3.fromRGB(255, 80, 100),
        Premium = Color3.fromRGB(255, 215, 0),
    },
    PREMIUM_SCRIPTS = {
        {emoji = "ðŸš«", name = "Auto-Block", url = "https://raw.githubusercontent.com/sabscripts063-cloud/Kdml-Not-Me/refs/heads/main/BlockPlayer"},
        {emoji = "âš¡", name = "Nameless", url = "https://raw.githubusercontent.com/ily123950/Vulkan/refs/heads/main/Tr"},
        {emoji = "ðŸ’»", name = "Admin Panel", url = "https://pastefy.app/PwlxhXHs/raw"},
        {emoji = "ðŸ”’", name = "Allow Friends", url = "https://pastebin.com/raw/aipXbhpf"},
        {emoji = "âš¡", name = "Speed Boost", url = "https://raw.githubusercontent.com/Tigyiscute/tigystealabrainrotscript/refs/heads/main/TigyHelper"},
    }
}

-- ============================================================
-- Ã‰TAT
-- ============================================================
local State = {
    isTeleporting = false,
    lastTeleportTime = 0,
    totalTeleports = 0,
    guiVisible = true,
    wallhackEnabled = false,
    wallhackParts = {},
    wallhackConnection = nil,
    espEnabled = false,
    espBoxes = {},
    espConnections = {},
    optimizerEnabled = false,
    currentCategory = "Misc",
    loadedScripts = {},
}

-- ============================================================
-- SYSTÃˆME DE DRAG (DÃ‰PLACEMENT)
-- ============================================================
local function makeDraggable(frame)
    local dragging = false
    local dragInput, dragStart, startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

-- ============================================================
-- FONCTIONS UTILITAIRES
-- ============================================================
local function getHRP()
    local char = LocalPlayer.Character
    if not char then return nil end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChild("Humanoid")
    if hrp and humanoid and humanoid.Health > 0 then
        return hrp
    end
    return nil
end

local function canTeleport()
    if State.isTeleporting then return false, "En cours..." end
    if tick() - State.lastTeleportTime < CONFIG.COOLDOWN then return false, "Cooldown..." end
    if not getHRP() then return false, "Erreur..." end
    return true, "PrÃªt"
end

local function tween(object, properties, duration)
    local info = TweenInfo.new(duration or 0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
    local tw = TweenService:Create(object, info, properties)
    tw:Play()
    return tw
end

local function teleportSequence()
    local canTP, message = canTeleport()
    if not canTP then return false, message end
    
    State.isTeleporting = true
    State.lastTeleportTime = tick()
    
    local success = pcall(function()
        for i, waypoint in ipairs(CONFIG.WAYPOINTS) do
            local hrp = getHRP()
            if not hrp then error("Personnage perdu") end
            hrp.CFrame = CFrame.new(waypoint.pos)
            if i < #CONFIG.WAYPOINTS then task.wait(CONFIG.DELAY) end
        end
    end)
    
    State.isTeleporting = false
    if success then State.totalTeleports += 1 return true, "SuccÃ¨s!" else return false, "Ã‰chec" end
end

local function toggleOptimizer(enabled)
    if enabled then
        settings().Rendering.QualityLevel = 1
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire") or obj:IsA("Sparkles") then
                obj.Enabled = false
            end
        end
        return true, "Optimizer activÃ©"
    else
        settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
        return true, "Optimizer dÃ©sactivÃ©"
    end
end

local function clearWallhack()
    for part, data in pairs(State.wallhackParts) do
        if part and part.Parent then part.LocalTransparencyModifier = data.OriginalTransparency or 0 end
    end
    State.wallhackParts = {}
    if State.wallhackConnection then State.wallhackConnection:Disconnect() State.wallhackConnection = nil end
end

local function toggleWallhack(enabled)
    State.wallhackEnabled = enabled
    if enabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("BasePart") and obj.Name ~= "Terrain" then
                local isPlayerPart = LocalPlayer.Character and obj:IsDescendantOf(LocalPlayer.Character)
                if not isPlayerPart then
                    State.wallhackParts[obj] = {OriginalTransparency = obj.LocalTransparencyModifier}
                    obj.LocalTransparencyModifier = 0.8
                end
            end
        end
        State.wallhackConnection = workspace.DescendantAdded:Connect(function(obj)
            if State.wallhackEnabled and obj:IsA("BasePart") then
                task.wait(0.1)
                if State.wallhackEnabled then
                    local isPlayerPart = LocalPlayer.Character and obj:IsDescendantOf(LocalPlayer.Character)
                    if not isPlayerPart then
                        obj.LocalTransparencyModifier = 0.8
                        State.wallhackParts[obj] = {OriginalTransparency = 0}
                    end
                end
            end
        end)
    else clearWallhack() end
end

local function clearESP()
    for _, data in pairs(State.espBoxes) do
        if data.Box then data.Box:Destroy() end
        if data.NameLabel then data.NameLabel:Destroy() end
    end
    State.espBoxes = {}
    for _, connection in pairs(State.espConnections) do
        if connection then connection:Disconnect() end
    end
    State.espConnections = {}
end

local function createRainbowESP(player)
    if player == LocalPlayer or not player.Character then return end
    local char = player.Character
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local head = char:FindFirstChild("Head")
    if not hrp or not head then return end
    
    local box = Instance.new("BoxHandleAdornment")
    box.Name = "ESP_" .. player.Name
    box.Adornee = hrp
    box.Size = Vector3.new(4, 5, 1)
    box.Color3 = Color3.fromRGB(255, 0, 0)
    box.Transparency = 0.3
    box.AlwaysOnTop = true
    box.ZIndex = 10
    box.Parent = hrp
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "ESP_Name_" .. player.Name
    billboardGui.Adornee = head
    billboardGui.Size = UDim2.new(0, 200, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 2.5, 0)
    billboardGui.AlwaysOnTop = true
    billboardGui.Parent = head
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 1, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = player.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextSize = 18
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Parent = billboardGui
    
    State.espBoxes[player.UserId] = {Box = box, NameLabel = billboardGui}
    
    local humanoid = char:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.Died:Connect(function()
            if State.espBoxes[player.UserId] then
                if State.espBoxes[player.UserId].Box then State.espBoxes[player.UserId].Box:Destroy() end
                if State.espBoxes[player.UserId].NameLabel then State.espBoxes[player.UserId].NameLabel:Destroy() end
                State.espBoxes[player.UserId] = nil
            end
        end)
    end
end

local function toggleESP(enabled)
    State.espEnabled = enabled
    if enabled then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then createRainbowESP(player) end
        end
        table.insert(State.espConnections, Players.PlayerAdded:Connect(function(player)
            if State.espEnabled then
                player.CharacterAdded:Connect(function()
                    task.wait(0.5)
                    if State.espEnabled then createRainbowESP(player) end
                end)
            end
        end))
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                table.insert(State.espConnections, player.CharacterAdded:Connect(function()
                    task.wait(0.5)
                    if State.espEnabled then createRainbowESP(player) end
                end))
            end
        end
    else clearESP() end
end

local function loadPremiumScript(scriptData, btn, icon)
    local scriptName = scriptData.name
    icon.Text = "â³"
    icon.TextColor3 = CONFIG.THEME.Accent
    btn.Text = scriptData.emoji .. " " .. scriptName .. " - Chargement..."
    
    local success = pcall(function() loadstring(game:HttpGet(scriptData.url))() end)
    
    if success then
        State.loadedScripts[scriptName] = true
        icon.Text = "âœ“"
        icon.TextColor3 = CONFIG.THEME.Success
        btn.Text = scriptData.emoji .. " " .. scriptName .. " - ChargÃ©!"
        task.wait(2)
        btn.Text = scriptData.emoji .. " " .. scriptData.name
        icon.Text = "â—"
        icon.TextColor3 = CONFIG.THEME.Success
    else
        icon.Text = "âœ•"
        icon.TextColor3 = CONFIG.THEME.Error
        btn.Text = scriptData.emoji .. " " .. scriptName .. " - Erreur"
        task.wait(2)
        btn.Text = scriptData.emoji .. " " .. scriptData.name
        icon.Text = "â—‹"
        icon.TextColor3 = CONFIG.THEME.TextDim
    end
end

-- ============================================================
-- INTERFACE
-- ============================================================
local function createCategorizedGUI()
    local existing = PlayerGui:FindFirstChild("MinimalTP_GUI")
    if existing then existing:Destroy() end
    
    local gui = Instance.new("ScreenGui")
    gui.Name = "MinimalTP_GUI"
    gui.ResetOnSpawn = false
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    gui.Parent = PlayerGui
    
    -- BOUTON RÃ‰OUVERTURE (DRAGGABLE)
    local reopenBtn = Instance.new("TextButton")
    reopenBtn.Name = "ReopenButton"
    reopenBtn.Size = UDim2.new(0, 50, 0, 50)
    reopenBtn.Position = UDim2.new(1, -60, 0, 10)
    reopenBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    reopenBtn.Text = "Vhub"
    reopenBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    reopenBtn.Font = Enum.Font.GothamBold
    reopenBtn.TextSize = 14
    reopenBtn.Visible = false
    reopenBtn.Active = true
    reopenBtn.Draggable = false -- On utilise notre propre systÃ¨me
    reopenBtn.Parent = gui
    Instance.new("UICorner", reopenBtn).CornerRadius = UDim.new(0, 8)
    local reopenStroke = Instance.new("UIStroke", reopenBtn)
    reopenStroke.Color = Color3.fromRGB(0, 80, 180)
    reopenStroke.Thickness = 3
    
    -- ANIMATION RAINBOW POUR LE CONTOUR
    task.spawn(function()
        local hue = 0
        while true do
            hue = (hue + 1) % 360
            reopenStroke.Color = Color3.fromHSV(hue / 360, 1, 1)
            task.wait(0.01) -- Change toutes les 0.01 secondes pour effet fluide
        end
    end)
    
    -- RENDRE LE BOUTON RÃ‰OUVERTURE DRAGGABLE
    makeDraggable(reopenBtn)
    
    -- FRAME PRINCIPALE (DRAGGABLE)
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 550, 0, 450)
    mainFrame.Position = UDim2.new(0.5, -275, 0.5, -225)
    mainFrame.BackgroundColor3 = CONFIG.THEME.Background
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.ClipsDescendants = true
    mainFrame.Parent = gui
    Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 12)
    local mainStroke = Instance.new("UIStroke", mainFrame)
    mainStroke.Color = Color3.fromRGB(0, 80, 180)
    mainStroke.Thickness = 2
    
    -- ANIMATION RAINBOW POUR LE CONTOUR DE L'INTERFACE PRINCIPALE
    task.spawn(function()
        local hue = 0
        while true do
            hue = (hue + 1) % 360
            mainStroke.Color = Color3.fromHSV(hue / 360, 1, 1)
            task.wait(0.01) -- Change en continu pour effet fluide
        end
    end)
    
    -- HEADER (ZONE DE DRAG)
    local header = Instance.new("Frame", mainFrame)
    header.Name = "Header"
    header.Size = UDim2.new(1, 0, 0, 60)
    header.BackgroundColor3 = CONFIG.THEME.Background
    header.BorderSizePixel = 0
    header.Active = true
    local headerStroke = Instance.new("UIStroke", header)
    headerStroke.Color = Color3.fromRGB(0, 80, 180)
    headerStroke.Thickness = 2
    headerStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    
    -- ANIMATION RAINBOW POUR LE CONTOUR DU HEADER
    task.spawn(function()
        local hue = 0
        while true do
            hue = (hue + 1) % 360
            headerStroke.Color = Color3.fromHSV(hue / 360, 1, 1)
            task.wait(0.01) -- SynchronisÃ© avec le contour principal
        end
    end)
    
    -- RENDRE L'INTERFACE PRINCIPALE DRAGGABLE VIA LE HEADER
    makeDraggable(mainFrame)
    
    local logo = Instance.new("TextLabel", header)
    logo.Size = UDim2.new(1, -60, 1, 0)
    logo.Position = UDim2.new(0, 20, 0, 0)
    logo.BackgroundTransparency = 1
    logo.Text = "Vhub"
    logo.TextColor3 = CONFIG.THEME.Text
    logo.Font = Enum.Font.GothamBold
    logo.TextSize = 32
    logo.TextXAlignment = Enum.TextXAlignment.Left
    
    local closeBtn = Instance.new("TextButton", header)
    closeBtn.Size = UDim2.new(0, 35, 0, 35)
    closeBtn.Position = UDim2.new(1, -45, 0, 12)
    closeBtn.BackgroundColor3 = CONFIG.THEME.TextDim
    closeBtn.BackgroundTransparency = 0.8
    closeBtn.Text = "âœ•"
    closeBtn.TextColor3 = CONFIG.THEME.Text
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 18
    closeBtn.AutoButtonColor = false
    Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1, 0)
    
    closeBtn.MouseButton1Click:Connect(function()
        State.guiVisible = false
        mainFrame.Visible = false
        reopenBtn.Visible = true
    end)
    
    reopenBtn.MouseButton1Click:Connect(function()
        State.guiVisible = true
        mainFrame.Visible = true
        reopenBtn.Visible = false
    end)
    
    local sidebar = Instance.new("Frame", mainFrame)
    sidebar.Name = "Sidebar"
    sidebar.Size = UDim2.new(0, 110, 1, -100)
    sidebar.Position = UDim2.new(0, 10, 0, 70)
    sidebar.BackgroundTransparency = 1
    local sidebarLayout = Instance.new("UIListLayout", sidebar)
    sidebarLayout.FillDirection = Enum.FillDirection.Vertical
    sidebarLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
    sidebarLayout.VerticalAlignment = Enum.VerticalAlignment.Top
    sidebarLayout.Padding = UDim.new(0, 8)
    
    local contentFrame = Instance.new("ScrollingFrame", mainFrame)
    contentFrame.Name = "ContentFrame"
    contentFrame.Size = UDim2.new(1, -140, 1, -110)
    contentFrame.Position = UDim2.new(0, 130, 0, 70)
    contentFrame.BackgroundTransparency = 1
    contentFrame.BorderSizePixel = 0
    contentFrame.ScrollBarThickness = 4
    contentFrame.ScrollBarImageColor3 = CONFIG.THEME.Accent
    contentFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    
    local footer = Instance.new("TextLabel", mainFrame)
    footer.Name = "Footer"
    footer.Size = UDim2.new(1, 0, 0, 30)
    footer.Position = UDim2.new(0, 0, 1, -35)
    footer.BackgroundTransparency = 1
    footer.Text = "by 8v & 6v & 4v | ðŸ–±ï¸ Glisse pour dÃ©placer"
    footer.TextColor3 = CONFIG.THEME.TextDim
    footer.Font = Enum.Font.Gotham
    footer.TextSize = 12
    footer.TextXAlignment = Enum.TextXAlignment.Center
    
    local tabs = {}
    local function createTab(name)
        local tabBtn = Instance.new("TextButton", sidebar)
        tabBtn.Name = name .. "Tab"
        tabBtn.Size = UDim2.new(1, 0, 0, 40)
        tabBtn.BackgroundColor3 = CONFIG.THEME.TextDim
        tabBtn.BackgroundTransparency = 0.9
        tabBtn.Text = name
        tabBtn.TextColor3 = CONFIG.THEME.TextDim
        tabBtn.Font = Enum.Font.GothamBold
        tabBtn.TextSize = 13
        tabBtn.AutoButtonColor = false
        Instance.new("UICorner", tabBtn).CornerRadius = UDim.new(0, 8)
        
        local contentContainer = Instance.new("Frame", contentFrame)
        contentContainer.Name = name .. "Content"
        contentContainer.Size = UDim2.new(1, -10, 0, 0)
        contentContainer.BackgroundTransparency = 1
        contentContainer.Visible = false
        local contentLayout = Instance.new("UIListLayout", contentContainer)
        contentLayout.FillDirection = Enum.FillDirection.Vertical
        contentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
        contentLayout.Padding = UDim.new(0, 10)
        
        contentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            contentContainer.Size = UDim2.new(1, -10, 0, contentLayout.AbsoluteContentSize.Y + 10)
            local maxHeight = 0
            for _, tab in pairs(tabs) do
                if tab.Content.Visible then
                    local layout = tab.Content:FindFirstChildOfClass("UIListLayout")
                    if layout then maxHeight = math.max(maxHeight, layout.AbsoluteContentSize.Y + 20) end
                end
            end
            contentFrame.CanvasSize = UDim2.new(0, 0, 0, maxHeight)
        end)
        
        tabs[name] = {Button = tabBtn, Content = contentContainer}
        
        tabBtn.MouseButton1Click:Connect(function()
            for tabName, tabData in pairs(tabs) do
                tabData.Content.Visible = false
                tabData.Button.BackgroundTransparency = 0.9
                tabData.Button.TextColor3 = CONFIG.THEME.TextDim
            end
            contentContainer.Visible = true
            tabBtn.BackgroundTransparency = 0.5
            tabBtn.TextColor3 = CONFIG.THEME.Accent
            State.currentCategory = name
            local layout = contentContainer:FindFirstChildOfClass("UIListLayout")
            if layout then contentFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 20) end
        end)
        
        return contentContainer
    end
    
    local miscContent = createTab("Misc")
    local espContent = createTab("ESP")
    local premiumContent = createTab("Premium")
    local keyContent = createTab("Key")
    local infoContent = createTab("Info")
    
    tabs["Misc"].Content.Visible = true
    tabs["Misc"].Button.BackgroundTransparency = 0.5
    tabs["Misc"].Button.TextColor3 = CONFIG.THEME.Accent
    
    local function createButton(parent, name, callback)
        local btn = Instance.new("TextButton", parent)
        btn.Name = name .. "Btn"
        btn.Size = UDim2.new(1, 0, 0, 50)
        btn.BackgroundColor3 = CONFIG.THEME.TextDim
        btn.BackgroundTransparency = 0.9
        btn.Text = name
        btn.TextColor3 = CONFIG.THEME.Text
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 15
        btn.AutoButtonColor = false
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
        local btnStroke = Instance.new("UIStroke", btn)
        btnStroke.Color = CONFIG.THEME.TextDim
        btnStroke.Thickness = 1
        local statusIcon = Instance.new("TextLabel", btn)
        statusIcon.Name = "StatusIcon"
        statusIcon.Size = UDim2.new(0, 30, 0, 30)
        statusIcon.Position = UDim2.new(1, -40, 0.5, -15)
        statusIcon.BackgroundTransparency = 1
        statusIcon.Text = "â—‹"
        statusIcon.TextColor3 = CONFIG.THEME.TextDim
        statusIcon.Font = Enum.Font.GothamBold
        statusIcon.TextSize = 18
        btn.MouseEnter:Connect(function() tween(btn, {BackgroundTransparency = 0.7}, 0.2) end)
        btn.MouseLeave:Connect(function() tween(btn, {BackgroundTransparency = 0.9}, 0.2) end)
        if callback then btn.MouseButton1Click:Connect(function() callback(btn, statusIcon) end) end
        return btn, statusIcon
    end
    
    local function createLabel(parent, text, color)
        local label = Instance.new("TextLabel", parent)
        label.Size = UDim2.new(1, 0, 0, 30)
        label.BackgroundTransparency = 1
        label.Text = text
        label.TextColor3 = color or CONFIG.THEME.Text
        label.Font = Enum.Font.Gotham
        label.TextSize = 14
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.TextWrapped = true
        return label
    end
    
    createButton(miscContent, "TÃ©lÃ©porter", function(btn, icon)
        local success, msg = teleportSequence()
        if success then
            icon.Text = "âœ“"
            icon.TextColor3 = CONFIG.THEME.Success
            task.wait(1)
            icon.Text = "â—‹"
            icon.TextColor3 = CONFIG.THEME.TextDim
        end
    end)
    
    createButton(miscContent, "Optimizer", function(btn, icon)
        State.optimizerEnabled = not State.optimizerEnabled
        toggleOptimizer(State.optimizerEnabled)
        if State.optimizerEnabled then
            icon.Text = "â—"
            icon.TextColor3 = CONFIG.THEME.Accent
        else
            icon.Text = "â—‹"
            icon.TextColor3 = CONFIG.THEME.TextDim
        end
    end)
    
    createButton(espContent, "ESP", function(btn, icon)
        State.espEnabled = not State.espEnabled
        toggleESP(State.espEnabled)
        if State.espEnabled then
            icon.Text = "â—"
            icon.TextColor3 = CONFIG.THEME.Success
        else
            icon.Text = "â—‹"
            icon.TextColor3 = CONFIG.THEME.TextDim
        end
    end)
    
    createButton(espContent, "Wallhack", function(btn, icon)
        State.wallhackEnabled = not State.wallhackEnabled
        toggleWallhack(State.wallhackEnabled)
        if State.wallhackEnabled then
            icon.Text = "â—"
            icon.TextColor3 = CONFIG.THEME.Success
        else
            icon.Text = "â—‹"
            icon.TextColor3 = CONFIG.THEME.TextDim
        end
    end)
    
    createLabel(premiumContent, "âœ¨ Scripts Premium", CONFIG.THEME.Premium)
    createLabel(premiumContent, "Clique pour charger un script", CONFIG.THEME.TextDim)
    
    for _, scriptData in ipairs(CONFIG.PREMIUM_SCRIPTS) do
        createButton(premiumContent, scriptData.emoji .. " " .. scriptData.name, function(btn, icon)
            loadPremiumScript(scriptData, btn, icon)
        end)
    end
    
    createLabel(keyContent, "Raccourcis clavier:", CONFIG.THEME.Accent)
    createLabel(keyContent, "[T] - TÃ©lÃ©porter", CONFIG.THEME.Text)
    createLabel(keyContent, "[INSERT] - Ouvrir/Fermer", CONFIG.THEME.Text)
    
    createLabel(infoContent, "Discord:", CONFIG.THEME.Accent)
    local discordBtn = Instance.new("TextButton", infoContent)
    discordBtn.Size = UDim2.new(1, 0, 0, 50)
    discordBtn.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    discordBtn.Text = "discord.gg/invite"
    discordBtn.TextColor3 = CONFIG.THEME.Text
    discordBtn.Font = Enum.Font.GothamBold
    discordBtn.TextSize = 16
    Instance.new("UICorner", discordBtn).CornerRadius = UDim.new(0, 8)
    
    discordBtn.MouseButton1Click:Connect(function()
        setclipboard("https://discord.gg/invite")
    end)
    
    createLabel(infoContent, "Version: 1.0.0", CONFIG.THEME.TextDim)
    createLabel(infoContent, "CrÃ©Ã© par 8v & 6v & 4v", CONFIG.THEME.TextDim)
end

createCategorizedGUI()

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.T then
        teleportSequence()
    elseif input.KeyCode == Enum.KeyCode.Insert then
        local mainFrame = PlayerGui:FindFirstChild("MinimalTP_GUI"):FindFirstChild("MainFrame")
        local reopenBtn = PlayerGui:FindFirstChild("MinimalTP_GUI"):FindFirstChild("ReopenButton")
        if mainFrame and reopenBtn then
            State.guiVisible = not State.guiVisible
            mainFrame.Visible = State.guiVisible
            reopenBtn.Visible = not State.guiVisible
        end
    end
end)
